<template name="game">
  
  <h2 class="text-center">Game</h2>

  {{#if invalid}}
    <p>Warning: Invalid game ID in URL.</p>
  {{else}}

    {{#with game}}
      {{> game_meta_data}}
   
      <br />
      <br />

      {{> game_boards game=game ownBoard=ownBoard attackBoard=attackBoard}}

      <br />
      <br />

      {{> game_actions}}
      {{> game_meta_foot game=game}}
    {{/with}}
  {{/if}}
</template>

<template name="game_meta_data">
  <div class="row text-center game-meta-data">
    <div class="col-sm-1"></div>
    <div class="col-sm-4">
      <h3>Player 1</h3>
      <p>{{ownName}}</p>
    </div>
    <div class="col-sm-2">
      <h3>Turn</h3>
      <p>{{turn_number}}</p>
    </div>
    <div class="col-sm-4">
      <h3>Player 2</h3>
      <p>{{opponentName}}</p>
    </div>
    <div class="col-sm-1"></div>
  </div>
</template>

<template name="game_boards">
  <div class="row text-center">
    <div class="col-sm-6">
      <strong>Your Board</strong>
      {{> board board=ownBoard.squares game=game own=true}}
      {{> sunk_ships sunk=ownBoard.sunk}}
    </div>
    <div class="col-sm-6">
      <strong>Their Board</strong>
      {{> board board=attackBoard.squares game=game own=false}}
      {{> sunk_ships sunk=attackBoard.sunk}}
    </div>
  </div>
</template>

<template name="sunk_ships">
  Ships sunk:
  <ul class="sunkships">
  {{#if sunk}}
    {{#each sunk}}
      <li>{{this}}</li>
    {{/each}}
  {{else}}
    <li>None yet!</li>
  {{/if}}
  </ul>
</template>

<template name="game_actions">
  {{#if active}}
  <div class="row text-center">
    <div class="col-sm-12">
      <p>
        <input type="text" name="selection" id="selection" disabled="true" size="5" />
        <button class="fireShot">Fire!</button>
      </p>
    </div>
  </div>
  {{/if}}
  {{#if ended}}
  <div class="row text-center">
    <div class="col-sm-12">
    </div>
  </div>
  {{/if}}
</template>

<template name="game_meta_foot">
  <div class="row text-center">
    <div class="col-sm-12">
      {{#if game.time_finished}}
      <p>Game over! The winner is: {{winner}}!</p>
      {{/if}}
      <div class="small">
        <p>Game created: {{dateFormat game.created_at}}</p>
        {{#if game.time_started}}
        <p>Game started: {{dateFormat game.time_started}}</p>
        {{/if}}
        {{#if game.time_finished}}
        <p>Game ended: {{dateFormat game.time_finished}}</p>
        {{/if}}
      </div>
    </div>
  </div>
</template>